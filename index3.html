<!DOCTYPE html>
<html>
<head>
    <title>Socket.IO Stream Example</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.1.3/socket.io.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io-stream/0.9.1/socket.io-stream.min.js"></script>
</head>
<body>
<input type="file" id="fileInput">
<button id="uploadButton">Upload File</button>

<script>
    var socket = io.connect('http://localhost:3001/test');
    var stream = ss.createStream();
    var filename = 'profile.jpg';

    // Отправка файла по событию 'profile-image'
    ss(socket).emit('profile-image', stream, {name: filename});

    // Обработка нажатия кнопки "Upload File"
    document.getElementById('uploadButton').addEventListener('click', () => {
        var fileInput = document.getElementById('fileInput');
        var selectedFile = fileInput.files[0];

        if (!selectedFile) {
            alert('Please select a file');
            return;
        }

        // Чтение и передача файла через поток
        var reader = new FileReader();
        reader.onload = function () {
            var arrayBuffer = this.result;
            var uint8Array = new Uint8Array(arrayBuffer);
            var buffer = uint8Array.buffer;
            stream.write(buffer);
            stream.end();
        };
        reader.readAsArrayBuffer(selectedFile);
    });
</script>
</body>
</html>
